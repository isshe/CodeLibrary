
[TOC]

# sk_buff分配与释放
数据缓冲区和报头(sk_buff数据结构)是两种不同的实例。
也就是说，建立一个缓冲区会涉及到两次内存分配：
* 先分配sk_buff结构——从内存池里；
* 再分配一块`强制对齐`的内存，存放实际的数据包（包括头部）；
    * skb->head/data指向此内存区域；
* 强制对齐示意图如下：
```
skb->head/data/tail---> +-------+   ---     ---
                        |       |    |       |
                        |       |   size   SKB_DATA_ALIGN(size)
                        |       |    |       |
                        +-------+   ---      |
                        |填充区域|            |
skb->end -------------> +-------+           ---
```


## 1.分配
```c
#include <linux/skbuff.h>

static inline struct sk_buff *alloc_skb(unsigned int size, gfp_t priority);

```


## 2.释放
