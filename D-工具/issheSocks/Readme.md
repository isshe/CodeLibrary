
[TOC]

issheSocks
---

# TODO
> 分段实现，详见docs

* 学习libevent
* 实现socks5到issheClient的TCP通信。
    * 解析socks5，转换到个人的协议
* 实现issheClient到issheServer的通信。
* 后续考虑KCP之类的。

# 项目目的
* 快速学习隧道/代理相关知识，为下一步学习内网穿透/UDP打洞、UDP事务做准备。
* 增加自身对网络编程的认识；后续实现一个http服务器

# 要求
* 虽然是学习，但是还是要尽量完善，能作为一个拿得出手的个人作品。

# 需求
> 优先级从高到低
> 先实现一版直接UDP隧道TCP的，后续再考虑用KCP。
> 先实现一版多连接多隧道的，后续优化：多连接单隧道。

* 实现基本功能，实现科学上网。
    * issheSocks客户端
        * 一个socks5服务器，接收主机通过socks5发过来的信息
        * 解析socks5信息
        * 封装信息，发送给issheSocks 
        * 后续考虑实现为支持多服务器的模式。
    * issheSocks服务器
        * 接收客户端信息
        * 代理客户端连接到服务器
        * 隧道管理
        * 封装服务器返回的信息
        * 返回信息给客户端
        * 先实现为一个服务器接收多个隧道信息，后续实现为服务器+多进程+缓存队列的形式
    * 最好能布在aliyun上不被发现啦...哇咔咔...
* 基于UDP（尽量可修改）
* 支持自定义协议（或者不使用协议）
  * 客户端处就剥离socks5的信息；后续使用自定义协议
* 模块化，方便加密算法拓展
    * 可自定义一些乱七八糟的算法来测试/使用
* 支持多种模式
    * socks5(全局)
    * 自动代理(局部)


# 使用

# SOCKS5握手过程




# 问题
```
  (1)             (2)              (3)
+-----+         +-----+         +-----+
| IP  |         | IP  |         | IP  |
+-----+  --->   +-----+  --->   +-----+  ---> | Http Server |
| TCP |         | UDP |         | TCP |
+-----+         +-----+         +-----+
                | IP  |
                +-----+
                | TCP |
                +-----+
```
问题：
* 1.xkcptun的上层协议，是只能是TCP吗？
* 2.在步骤3中，是如何开socket（以什么参数？协议类型？）以发送这个TCP报文段的？
* 3.要用什么socket类型才能接收到Http Server或其他server的回复？


# 阶段
* 阶段1
  * 实现最简单版本

* 阶段2
  * 协议握手混淆
  * 给写出增加可靠性